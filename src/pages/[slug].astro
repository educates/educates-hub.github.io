---
import { loadEducatesResources } from "../utils/loadWorkshops";
import type { EducatesResourceBase } from "../utils/loadWorkshops";
import MainLayout from "../layouts/MainLayout.astro";
import WorkshopDetail from '../components/WorkshopDetail.jsx';
import ExtensionPackageDetail from '../components/ExtensionPackageDetail.jsx';

export async function getStaticPaths() {
  const resources = await loadEducatesResources();
  return resources.map((r) => ({
    params: { slug: r.slug },
  }));
}

const { slug } = Astro.params;
const resources = await loadEducatesResources();
const resource: EducatesResourceBase | undefined = resources.find((r) => r.slug === slug);
if (!resource) {
  throw new Error("Resource not found");
}
---

<MainLayout
  title={`${resource.title} - EducatesHub - ${resource.type}`}
  description={resource.description}
>
  {resource.type === 'Workshop' ? (
    <WorkshopDetail client:load workshop={resource} />
  ) : resource.type === 'ExtensionPackage' ? (
    <ExtensionPackageDetail client:load extensionPackage={resource} />
  ) : null}
</MainLayout>
